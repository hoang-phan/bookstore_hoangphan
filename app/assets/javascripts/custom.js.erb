$(function(){
  $("#per-page").val($("#tag-per-page").val());

  $(".rating-star").hover(function(){
    $(this).prevAll().attr("src", "/assets/star-active.png");
    $(this).attr("src", "/assets/star-active.png");
    $(this).nextAll().attr("src", "/assets/star-inactive.png");
  });

  $(".rating-star").click(function(){
    $(".rating").val($(".rating-star").index(this) + 1);
    $("#form-rating").submit();
  });

  $("#per-page").change(function(){
    $.post("/books/change_per_page", { per_page: $(this).val() }, function(){
      window.location.reload();
    });
  });

  $("#choose-category").click(function(){
    $('#categories-menu').dropdown();
  });

  $("#category-search").click(function(){
    $('#search-menu').dropdown();
  });

  $("#search-menu li").click(function(){
    $("#category-search span").html("| " + $(this).find(".value").html());
    var category_id = $(this).find(".hidden").html();
    $("#category_id").val(category_id);
  });

  $("#search-button").click(function(){
    $("#search-top").submit();
  });

  $(".add-to-cart").click(function(){
    $.post("line_items", { book_id: $(this).find(".hidden").html() }, function(o) {
      $("#cart-count").html(o['cart_item']);
    });
  });
});
